{% extends 'base.html' %}
{% block title %}{{ movie.title }} • MoveM{% endblock %}
{% block content %}
<article class="mx-auto max-w-6xl space-y-10">
  {# -------------------- HERO SECTION -------------------- #}
  <section class="relative overflow-hidden rounded-[40px] border border-white/10 bg-black/70">

    <div class="grid gap-8 p-8 lg:grid-cols-[2fr,3fr]">

      {# -------------------- POSTER -------------------- #}
      <div class="relative">
        <img src="{{ movie.poster_url or url_for('static', filename='img/placeholder_poster.svg') }}" 
             alt="{{ movie.title }} poster" 
             class="w-full rounded-3xl object-cover" />
      </div>

      {# -------------------- FILM DETAILS -------------------- #}
      <div class="space-y-5">
        <p class="text-xs uppercase tracking-[0.4em] text-white/50">
          {{ movie.genre_list | join(' • ') }}
        </p>

        <h1 class="text-5xl font-display tracking-widest text-white">
          {{ movie.title }}
        </h1>

        <p class="text-lg text-white/70">
          {{ movie.tagline }}
        </p>

        <div class="flex flex-wrap gap-4 text-sm text-white/60">
          <span>Released {{ movie.release_date }}</span>
        </div>

        <div class="inline-block rounded-3xl border border-white/10 bg-white/5 px-3 py-1.5 text-sm text-white/80 mt-2">
        Favorited by {{ favorite_count }} people
      </div>


        <div class="flex flex-wrap gap-4">
          <form method="post" action="{{ url_for('toggle_favorite', movie_id=movie.id) }}">
            <button class="btn-primary" type="submit">
              {% if movie.is_favorite %}Remove from favorites{% else %}Add to favorites{% endif %}
            </button>
          </form>
          <a href="{{ url_for('movies') }}" class="btn-secondary">Back to catalog</a>
        </div>

    
    <div class="inline-block rounded-3xl border border-white/10 bg-white/5 px-4 py-3">
      <p class="text-xs uppercase tracking-[0.4em] text-white/60 mb-1">Where to watch</p>
      <div>
        {% if providers %}
          <span class="inline-flex items-center rounded-xl border border-white/20 bg-black/40 px-3 py-1.5 text-sm text-white">
            {{ providers[0].name }}
          </span>
        {% else %}
          <span class="text-xs text-white/60">Availability info coming soon.</span>
        {% endif %}
      </div>
    </div>


      </div>
    </div>
  </section>

{# -------------------- SYNOPSIS & PRODUCTION FACTS -------------------- #}
<section class="grid gap-6 lg:grid-cols-2">
  <div class="rounded-3xl border border-white/10 bg-black/60 p-6">
    <h2 class="text-2xl font-semibold uppercase tracking-[0.3em]">Synopsis</h2>
    <p class="mt-4 text-white/80 leading-relaxed">{{ movie.overview or "Overview not available." }}</p>

    {# Metrics #}
    <div class="mt-6 grid gap-4 sm:grid-cols-2">
      <div class="rounded-2xl border border-white/10 bg-white/5 p-4">
        <p class="text-xs uppercase tracking-[0.4em] text-white/60">Runtime</p>
        <p class="mt-2 text-2xl font-semibold text-white">{{ statistic.runtime | default('—') }} min</p>
      </div>
      <div class="rounded-2xl border border-white/10 bg-white/5 p-4">
        <p class="text-xs uppercase tracking-[0.4em] text-white/60">Rating</p>
        <p class="mt-2 text-2xl font-semibold text-white">{{ statistic.vote_avg | default('—') }}/10</p>
      </div>
    </div>
  </div>

  {# Production Facts #}
  <div class="rounded-3xl border border-white/10 bg-black/60 p-6">
    <h3 class="text-xl font-semibold uppercase tracking-[0.3em]">Production facts</h3>
    <dl class="mt-4 space-y-3 text-sm text-white/80">
      <div class="flex justify-between rounded-2xl border border-white/10 bg-white/5 px-4 py-3">
        <dt>Budget</dt>
        <dd>{{ statistic.budget | default('—') }}</dd>
      </div>
      <div class="flex justify-between rounded-2xl border border-white/10 bg-white/5 px-4 py-3">
        <dt>Revenue</dt>
        <dd>{{ statistic.revenue | default('—') }}</dd>
      </div>
    </dl>
  </div>
</section>


{# -------------------- CAST -------------------- #}
<section class="mt-6">
  <div class="flex items-center justify-between">
    <h3 class="text-2xl font-semibold uppercase tracking-[0.3em]">Cast</h3>
    <a href="{{ url_for('people') }}" class="text-xs uppercase tracking-[0.4em] text-white/60">Full credits</a>
  </div>
  <div class="mt-4 rail-scroll">
    {% for member in cast %}
    <div class="rail-card">
      <img src="{{ member.profile_url or url_for('static', filename='img/placeholder_avatar.svg') }}" alt="{{ member.name }}" />
      <div class="rail-card-content">
        <p>{{ member.name }}</p>
        <span class="text-xs text-white/70">as {{ member.character }}</span>
      </div>
    </div>
    {% else %}
    <p class="text-sm text-white/60">Cast details coming soon.</p>
    {% endfor %}
  </div>
</section>

{# -------------------- COMMUNITY REVIEWS -------------------- #}
<section class="mt-6 rounded-3xl border border-white/10 bg-black/60 p-6">
  <div class="flex items-center justify-between">
    <h3 class="text-xl font-semibold uppercase tracking-[0.3em]">Community reviews</h3>
    <span class="text-xs uppercase tracking-[0.4em] text-white/60">{{ reviews | length }} entries</span>
  </div>
  <div class="mt-4 space-y-4">
    {% for review in reviews %}
    <article class="rounded-2xl border border-white/10 bg-white/5 p-4">
      <div class="flex items-center justify-between text-sm">
        <strong class="text-white">{{ review.author }}</strong>
        <div class="flex items-center gap-1">
          {# Yıldızlı rating #}
          {% for i in range(1, 11) %}
            {% if i <= review.rating | round(0, 'floor') %}
              <span class="text-yellow-400">★</span>
            {% else %}
              <span class="text-white/40">★</span>
            {% endif %}
          {% endfor %}
          <span class="ml-2 text-white/60">{{ review.rating }}/10</span>
        </div>
      </div>
      <p class="mt-2 text-sm text-white/80">{{ review.comment }}</p>
    </article>
    {% else %}
    <p class="text-sm text-white/60">No comments yet. Be the first to share your thoughts.</p>
    {% endfor %}
  </div>

  {# Review form #}
  <form method="post" action="{{ url_for('add_review', movie_id=movie.id) }}" class="mt-6 space-y-4">
    <label class="text-xs uppercase tracking-[0.4em] text-white/60" for="rating">Leave a rating</label>
    <input class="form-field" type="number" name="rating" id="rating" min="1" max="10" step="0.5" placeholder="8.5" />
    <textarea class="form-field" name="comment" rows="4" placeholder="Share what you loved or not"></textarea>
    <button class="btn-primary">Submit review</button>
  </form>
</section>


</article>
{% endblock %}
