{% extends 'base.html' %}
{% block title %}Account â€¢ MoveM{% endblock %}
{% block content %}
<section class="mx-auto max-w-6xl space-y-10">
  <div class="relative overflow-hidden rounded-[40px] border border-white/10 bg-gradient-to-r from-black via-black/80 to-brand-800/40 p-8 sm:p-10">
    <div class="grid gap-8 lg:grid-cols-[2fr,1fr]">
      <div class="flex flex-col gap-4">
        <div class="flex items-center gap-4">
          <img src="{{ current_user.avatar or url_for('static', filename='img/placeholder_avatar.svg') }}" class="h-24 w-24 rounded-3xl object-cover ring-2 ring-white/20" alt="{{ current_user.first_name }} avatar" />
          <div>
            <p class="text-xs uppercase tracking-[0.4em] text-white/60">Profile</p>
            <h1 class="text-4xl font-display tracking-widest text-white">{{ current_user.first_name }} {{ current_user.last_name }}</h1>
            <p class="text-white/60">@{{ current_user.username }}</p>
          </div>
        </div>
        <p class="max-w-3xl text-lg text-white/80">{{ current_user.bio or 'Keep watching and build your cinematic fingerprint on MoveM.' }}</p>
        <div class="flex flex-wrap gap-4">
          <a href="{{ url_for('account_settings') }}" class="btn-primary">Manage account</a>
          <a href="{{ url_for('movies') }}" class="btn-secondary">View catalog</a>
        </div>
      </div>
      <div class="grid gap-3 text-center text-sm sm:grid-cols-3 lg:grid-cols-1">
        <div class="rounded-3xl border border-white/10 bg-white/5 p-4">
          <p class="text-xs uppercase tracking-[0.4em] text-white/60">Total score</p>
          <p class="text-3xl font-semibold text-white">{{ stats.score }}</p>
        </div>
        <div class="rounded-3xl border border-white/10 bg-white/5 p-4">
          <p class="text-xs uppercase tracking-[0.4em] text-white/60">Best streak</p>
          <p class="text-3xl font-semibold text-white">{{ stats.best_streak }}</p>
        </div>
        <div class="rounded-3xl border border-white/10 bg-white/5 p-4">
          <p class="text-xs uppercase tracking-[0.4em] text-white/60">Favorites</p>
          <p class="text-3xl font-semibold text-white">{{ favorites | length }}</p>
        </div>
      </div>
    </div>
  </div>

  <div class="grid gap-6 lg:grid-cols-[1.15fr,0.85fr]">
    <form method="post" class="space-y-6 rounded-3xl border border-white/10 bg-black/60 p-6 sm:p-8">
      <div class="flex items-center justify-between">
        <h2 class="text-2xl font-semibold uppercase tracking-[0.3em]">Profile details</h2>
        <span class="text-xs uppercase tracking-[0.4em] text-white/50">Auto saved</span>
      </div>
      <div class="grid gap-4 sm:grid-cols-2">
        <label class="text-xs uppercase tracking-[0.4em] text-white/60" for="first_name">First name
          <input class="form-field mt-2" name="first_name" value="{{ current_user.first_name }}" />
        </label>
        <label class="text-xs uppercase tracking-[0.4em] text-white/60" for="last_name">Last name
          <input class="form-field mt-2" name="last_name" value="{{ current_user.last_name }}" />
        </label>
      </div>
      <label class="text-xs uppercase tracking-[0.4em] text-white/60" for="bio">Bio
        <textarea class="form-field mt-2" name="bio" rows="4" placeholder="Share your film taste">{{ current_user.bio }}</textarea>
      </label>
      <div class="grid gap-4 sm:grid-cols-2">
        <label class="text-xs uppercase tracking-[0.4em] text-white/60">Region
          <select class="form-field mt-2">
            <option>Global</option>
            <option>Americas</option>
            <option>EMEA</option>
          </select>
        </label>
        <label class="text-xs uppercase tracking-[0.4em] text-white/60">Preferred language
          <select class="form-field mt-2">
            <option>English</option>
            <option>Spanish</option>
            <option>French</option>
          </select>
        </label>
      </div>
      <button class="btn-primary w-full">Save changes</button>
    </form>

    <div class="space-y-6">
      <section class="rounded-3xl border border-white/10 bg-black/60 p-6">
        <h3 class="text-lg font-semibold uppercase tracking-[0.3em]">Connected services</h3>
        <ul class="mt-4 space-y-3 text-sm text-white/80">
          <li class="flex items-center justify-between rounded-2xl border border-white/10 bg-white/5 px-3 py-2">
            <span>Netflix</span>
            <button type="button" class="text-xs text-brand-400">Manage</button>
          </li>
          <li class="flex items-center justify-between rounded-2xl border border-white/10 bg-white/5 px-3 py-2">
            <span>Prime Video</span>
            <button type="button" class="text-xs text-brand-400">Manage</button>
          </li>
          <li class="flex items-center justify-between rounded-2xl border border-dashed border-white/20 px-3 py-2 text-white/50">
            <span>+ Add provider</span>
          </li>
        </ul>
      </section>
      <section class="rounded-3xl border border-white/10 bg-black/60 p-6">
        <h3 class="text-lg font-semibold uppercase tracking-[0.3em]">Game stats</h3>
        <dl class="mt-4 space-y-4 text-sm">
          <div class="rounded-2xl border border-white/10 bg-white/5 p-4">
            <dt class="text-xs uppercase tracking-[0.4em] text-white/60">Accuracy</dt>
            <dd class="mt-2 text-3xl font-display text-white">{{ stats.accuracy }}%</dd>
            <div class="mt-3 h-2 rounded-full bg-white/10">
              <div class="h-full rounded-full bg-brand-500" style="width: {{ stats.accuracy }}%"></div>
            </div>
          </div>
          <div class="rounded-2xl border border-white/10 bg-white/5 p-4">
            <dt class="text-xs uppercase tracking-[0.4em] text-white/60">Games played</dt>
            <dd class="mt-2 text-2xl text-white">{{ stats.games_played }}</dd>
          </div>
        </dl>
      </section>
    </div>
  </div>

  <section class="space-y-4 rounded-3xl border border-white/10 bg-black/60 p-6">
    <div class="flex items-center justify-between">
      <h3 class="text-xl font-semibold uppercase tracking-[0.3em]">Favorites rail</h3>
      <span class="text-xs uppercase tracking-[0.4em] text-white/60">{{ favorites | length }} titles</span>
    </div>
    <div class="rail-scroll">
      {% for movie in favorites %}
      <a href="{{ url_for('movie_detail', movie_id=movie.id) }}" class="rail-card">
        <img src="{{ movie.poster_url or url_for('static', filename='img/placeholder_poster.svg') }}" alt="{{ movie.title }} poster" />
        <div class="rail-card-content">
          <p>{{ movie.title }}</p>
          <span class="text-xs text-white/70">{{ movie.release_date }}</span>
        </div>
      </a>
      {% else %}
      <p class="text-sm text-white/60">Save titles to see them here.</p>
      {% endfor %}
    </div>
  </section>

  <section class="grid gap-6 lg:grid-cols-2">
    <div class="rounded-3xl border border-white/10 bg-black/60 p-6">
      <h3 class="text-xl font-semibold uppercase tracking-[0.3em]">Recent activity</h3>
      <ul class="mt-4 space-y-3 text-sm text-white/80">
        {% for session in sessions %}
        <li class="flex items-start justify-between rounded-2xl border border-white/10 bg-white/5 px-4 py-3">
          <div>
            <p class="font-semibold text-white">{{ session.title }}</p>
            <p class="text-white/60">{{ session.timestamp }}</p>
          </div>
          <span class="text-xs uppercase tracking-[0.4em] text-white/60">{{ session.status }}</span>
        </li>
        {% else %}
        <li class="text-white/60">No recent sessions.</li>
        {% endfor %}
      </ul>
    </div>
    <div class="rounded-3xl border border-white/10 bg-black/60 p-6">
      <h3 class="text-xl font-semibold uppercase tracking-[0.3em]">Goals</h3>
      <div class="mt-4 space-y-4 text-sm text-white/80">
        <div class="rounded-2xl border border-white/10 bg-white/5 p-4">
          <p class="font-semibold text-white">Reach streak of 20</p>
          <div class="mt-3 h-2 rounded-full bg-white/10">
            <div class="h-full rounded-full bg-brand-500" style="width: {{ (stats.best_streak / 20 * 100) | round(0, 'floor') }}%"></div>
          </div>
          <p class="mt-2 text-xs uppercase tracking-[0.4em] text-white/60">Current {{ stats.best_streak }}/20</p>
        </div>
        <div class="rounded-2xl border border-white/10 bg-white/5 p-4">
          <p class="font-semibold text-white">Play 100 games</p>
          <div class="mt-3 h-2 rounded-full bg-white/10">
            <div class="h-full rounded-full bg-brand-500" style="width: {{ (stats.games_played / 100 * 100) | round(0, 'floor') }}%"></div>
          </div>
          <p class="mt-2 text-xs uppercase tracking-[0.4em] text-white/60">Current {{ stats.games_played }}/100</p>
        </div>
      </div>
    </div>
  </section>
</section>
{% endblock %}
