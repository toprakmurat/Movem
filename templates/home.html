{% extends 'base.html' %}  
{% block title %}Home • MoveM{% endblock %}  
{% block content %}
<section class="mb-12 space-y-10 mx-auto max-w-6xl">

  {# -------------------- HERO SECTION SLIDER -------------------- #}
  <div data-carousel class="relative h-[70vh] overflow-hidden rounded-[40px] border border-white/10 bg-black/60">

    {% for movie in trending_movies %}
    <div data-slide class="absolute inset-0 transition-all duration-700 {% if loop.first %}opacity-100 translate-x-0 pointer-events-auto{% else %}opacity-0 -translate-x-4 pointer-events-none{% endif %}">
      <img src="{{ movie.backdrop_url or movie.poster_url or url_for('static', filename='img/placeholder_poster.svg') }}" 
           alt="{{ movie.title }} backdrop" 
           class="absolute inset-0 h-full w-full object-cover opacity-70" />
      <div class="absolute inset-0 bg-gradient-to-r from-black via-black/70 to-transparent"></div>

      <div class="relative z-10 flex h-full flex-col justify-center gap-5 p-8 sm:p-12 lg:p-16 text-white">
        <p class="text-sm font-semibold uppercase tracking-[0.4em] text-brand-400">Now streaming</p>
        <h1 class="max-w-3xl text-5xl font-display uppercase tracking-[0.08em]">
          {{ movie.title }}
        </h1>
        <p class="max-w-2xl text-lg text-zinc-200 sm:text-xl">{{ movie.overview }}</p>

        <div class="flex flex-wrap gap-4 mt-4">
          <a href="{{ url_for('movie_detail', movie_id=movie.id) }}" class="btn-primary">View Details</a>
          <a href="{{ url_for('movies') }}" class="btn-secondary flex items-center gap-1">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M11.25 9v6m3.75-6v6M5 5l1.5 14h11L19 5H5z" />
            </svg>
            Browse Catalog
          </a>
        </div>

        <div class="flex flex-wrap gap-4 text-sm text-zinc-300 mt-2">
          <span class="rounded border border-white/20 px-3 py-1 text-xs uppercase tracking-widest">Exclusive</span>
          <span>{{ movie.release_date }}</span>
          <span>{{ movie.genre_list | join(' • ') }}</span>
        </div>
      </div>
    </div>
    {% endfor %}

    <button data-carousel-prev
          class="absolute left-4 top-1/2 -translate-y-1/2 z-20 text-white text-3xl font-bold opacity-70 hover:opacity-100">
    &#8592;
    </button>
    <button data-carousel-next
            class="absolute right-4 top-1/2 -translate-y-1/2 z-20 text-white text-3xl font-bold opacity-70 hover:opacity-100">
      &#8594;
    </button>

    <div class="absolute bottom-4 left-1/2 -translate-x-1/2 flex gap-2">
      {% for movie in trending_movies %}
      <button data-slide-nav="{{ loop.index0 }}" class="w-3 h-3 rounded-full bg-white/50" aria-current="{% if loop.first %}true{% else %}false{% endif %}"></button>
      {% endfor %}
    </div>

  </div>

</section>

  {# -------------------- POPULAR ON MOVEM (HORIZONTAL RAIL) -------------------- #}
  <section class="mb-12 mx-auto max-w-6xl">
    <div class="mb-3 flex items-center justify-between">
      <h2 class="text-2xl font-semibold uppercase tracking-[0.3em]">Popular on MoveM</h2>
      <div class="flex gap-3">
        <button class="btn-icon" type="button" data-rail-nav data-direction="prev" data-rail-target="popular">&larr;</button>
        <button class="btn-icon" type="button" data-rail-nav data-direction="next" data-rail-target="popular">&rarr;</button>
      </div>
    </div>

    <div class="rail-scroll" data-rail="popular">
      {% for movie in featured_movies %}
        {% include 'partials/movie_card.html' with context %}
      {% else %}
        <p class="text-sm text-zinc-400">Popular titles will be displayed soon.</p>
      {% endfor %}
    </div>
  </section>

  {# -------------------- PEOPLE SPOTLIGHT -------------------- #}
  <section class="mx-auto max-w-6xl space-y-6 mb-12">
    <div class="flex items-center justify-between">
      <h2 class="text-2xl font-semibold uppercase tracking-[0.3em]">People Spotlight</h2>
      <a href="{{ url_for('people') }}" class="text-sm uppercase tracking-[0.4em] text-white/70 hover:text-white">See all</a>
    </div>

    <div class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4">
      {% for person in featured_people %}
      <a href="{{ url_for('person_detail', person_id=person.id) }}" class="group rounded-2xl border border-white/10 bg-black/60 p-4 transition hover:border-white/40">
        <img src="{{ person.profile_url or url_for('static', filename='img/placeholder_profile.svg') }}" 
            alt="{{ person.name }}" 
            class="w-full h-56 object-cover rounded-xl mb-2" />
        <p class="text-white font-semibold">{{ person.name }}</p>
        <p class="text-sm text-zinc-400">{{ person.known_for }}</p>
      </a>
      {% else %}
      <p class="text-sm text-zinc-400">No people to display yet.</p>
      {% endfor %}
    </div>
  </section>

  {# -------------------- COLLECTIONS SPOTLIGHT -------------------- #}
  <section class="space-y-6 mb-12 mx-auto max-w-6xl">
    <div class="flex items-center justify-between">
      <h2 class="text-2xl font-semibold uppercase tracking-[0.3em]">Collections spotlight</h2>
      <a href="{{ url_for('movies') }}" class="text-sm uppercase tracking-[0.4em] text-white/70 hover:text-white">Browse all</a>
    </div>
    <div class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
      {% for collection in featured_collections %}
      <a href="{{ url_for('collection_detail', collection_id=collection.id) }}" class="group rounded-3xl border border-white/10 bg-gradient-to-br from-black via-black/70 to-brand-800/40 p-6 transition hover:border-white/40">
        <p class="text-xs uppercase tracking-[0.4em] text-white/60">Collection</p>
        <h3 class="mt-2 text-2xl font-display tracking-widest text-white">{{ collection.title }}</h3>
        <p class="mt-4 text-sm text-white/70">{{ collection.count }} curated titles</p>
        <span class="mt-6 inline-flex items-center text-sm text-brand-400">Open <span aria-hidden="true" class="ml-1">&rarr;</span></span>
      </a>
      {% else %}
      <p class="text-sm text-zinc-400">Add collections to spotlight them here.</p>
      {% endfor %}
    </div>
  </section>

    {# -------------------- CURATED DISCOVERY SLIDER (REPLACES COLLECTIONS) -------------------- #}
  <section class="mx-auto max-w-6xl space-y-6 mb-12">
    <div class="flex items-center justify-between">
      <div>
        <h2 class="text-2xl font-semibold uppercase tracking-[0.3em]">CineMetrics</h2>
        <span class="text-xs uppercase tracking-[0.4em] text-white/50">Recommendation Lists</span>
      </div>
      <!-- Slider Controls -->
      <div class="flex gap-3">
        <button class="btn-icon" type="button" data-rail-nav data-direction="prev" data-rail-target="curated">&larr;</button>
        <button class="btn-icon" type="button" data-rail-nav data-direction="next" data-rail-target="curated">&rarr;</button>
      </div>
    </div>

    <!-- The Slider (Rail) -->
    <div class="rail-scroll" data-rail="curated">
      {% for option in discovery_options %}
      <a href="{{ url_for('movies', filter=option.link_param) }}" class="w-80 shrink-0 group relative flex h-80 flex-col justify-end overflow-hidden rounded-3xl border border-white/10 bg-slate-900 transition-all duration-500 hover:scale-[1.02] hover:border-brand-500/50 hover:shadow-2xl hover:shadow-brand-900/20">

        <!-- Background Image (The "First Movie") -->
        <img src="{{ option.image }}"
            alt="{{ option.title }}"
            class="absolute inset-0 h-full w-full object-cover opacity-60 transition-transform duration-700 group-hover:scale-110 group-hover:opacity-40" />

        <!-- Gradient Overlay (To make text readable) -->
        <div class="absolute inset-0 bg-gradient-to-t from-black via-black/50 to-transparent"></div>

        <!-- Text Content -->
        <div class="relative z-10 p-6">
          <div class="mb-2 flex h-8 w-8 items-center justify-center rounded-full bg-brand-500/20 text-brand-300 backdrop-blur-md opacity-0 transition-all duration-300 group-hover:opacity-100">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" /></svg>
          </div>

          <p class="text-xs font-bold uppercase tracking-widest text-brand-400">{{ option.subtitle }}</p>
          <h3 class="mt-1 text-2xl font-display font-bold uppercase tracking-widest text-white">{{ option.title }}</h3>

          <!-- Fake "Button" Text -->
          <div class="mt-4 flex items-center gap-2 text-xs font-bold uppercase tracking-widest text-white/60 transition-colors group-hover:text-white">
            <span>Explore List</span>
            <span class="transition-transform group-hover:translate-x-1">&rarr;</span>
          </div>
        </div>
      </a>
      {% endfor %}
    </div>
  </section>

  {# -------------------- GENRE SPOTLIGHT (HORIZONTAL RAILS) -------------------- #}
  {% set genre_list = ['Action', 'Fantasy', 'Comedy', 'Drama', 'Sci-Fi'] %}
  {% for genre_name in genre_list %}
  <section class="mb-12 mx-auto max-w-6xl">
    <div class="mb-3 flex items-center justify-between">
      <h2 class="text-2xl font-semibold uppercase tracking-[0.3em]">{{ genre_name }} Movies</h2>
      <div class="flex gap-3">
        <button class="btn-icon" type="button" data-rail-nav data-direction="prev" data-rail-target="genre-{{ loop.index }}">&larr;</button>
        <button class="btn-icon" type="button" data-rail-nav data-direction="next" data-rail-target="genre-{{ loop.index }}">&rarr;</button>
      </div>
    </div>

    <div class="rail-scroll" data-rail="genre-{{ loop.index }}">
      {% for movie in featured_movies if genre_name in movie.genre_list %}
        {% include 'partials/movie_card.html' with context %}
      {% else %}
        <p class="text-sm text-zinc-400">No {{ genre_name }} movies available.</p>
      {% endfor %}
    </div>
  </section>
  {% endfor %}

  {# -------------------- TOP REVIEWERS / COMMUNITY RAIL -------------------- #}
  <section class="mb-12 mx-auto max-w-6xl">
    <div class="mb-3 flex items-center justify-between">
      <h2 class="text-2xl font-semibold uppercase tracking-[0.3em]">Top Reviewers</h2>
      <div class="flex gap-3">
        <button class="btn-icon" type="button" data-rail-nav data-direction="prev" data-rail-target="reviewers">&larr;</button>
        <button class="btn-icon" type="button" data-rail-nav data-direction="next" data-rail-target="reviewers">&rarr;</button>
      </div>
    </div>

    <div class="rail-scroll" data-rail="reviewers">
      {% for reviewer in top_reviewers[:10] %}
      <article class="group relative flex flex-col rounded-2xl border border-slate-800 bg-slate-900/60 shadow-lg transition hover:-translate-y-1 hover:border-brand-400/60 hover:shadow-brand-500/20">
        <a href="{{ url_for('person_detail', person_id=reviewer.id) }}" class="absolute inset-0 z-10" aria-label="View {{ reviewer.name }}"></a>
        <div class="aspect-[2/3] w-full overflow-hidden rounded-t-2xl">
          <img src="{{ reviewer.profile_url or url_for('static', filename='img/placeholder_profile.svg') }}" 
               alt="{{ reviewer.name }}" 
               class="h-full w-full object-cover transition duration-500 group-hover:scale-105" />
        </div>
        <div class="flex flex-1 flex-col gap-2 p-4">
          <h3 class="text-lg font-semibold text-white">{{ reviewer.name }}</h3>
          <p class="text-sm text-slate-400">{{ reviewer.known_for }}</p>
        </div>
      </article>
      {% else %}
      <p class="text-sm text-zinc-400">No reviewers available.</p>
      {% endfor %}
    </div>
</section>

</section>
{% endblock %}